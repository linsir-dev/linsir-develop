# 惰性求值与及早求值示例代码

## 概念说明

### 及早求值(Eager Evaluation)
及早求值是指在创建表达式或集合时立即执行计算并返回结果。当我们使用及早求值时，所有操作会立即执行，无论结果是否会被使用。

### 惰性求值(Lazy Evaluation)
惰性求值是指推迟计算，直到真正需要结果时才执行。当我们使用惰性求值时，操作会被延迟执行，直到调用终端操作或明确要求结果时才会触发计算。

## 区别对比

| 特性 | 及早求值 | 惰性求值 |
|------|----------|----------|
| 执行时机 | 立即执行 | 延迟执行 |
| 内存使用 | 通常较高，需要存储中间结果 | 通常较低，只在需要时计算 |
| 性能 | 对于多次使用相同结果的场景可能更高 | 对于只需要部分结果的场景通常更高 |
| 代码风格 | 命令式，更直观 | 函数式，更简洁 |
| 适用场景 | 计算结果会被多次使用，或需要立即验证结果 | 计算成本高，或只需要部分结果 |

## 示例代码说明

本目录包含以下示例代码：

1. **EagerEvaluationDemo.java**：及早求值演示，包括传统集合操作和Stream API的及早求值。
2. **LazyEvaluationDemo.java**：惰性求值演示，包括自定义惰性求值、Stream API的惰性求值和惰性链式调用。
3. **EvaluationTest.java**：测试类，用于运行所有示例代码并比较两种求值方式的性能。

## 运行测试

运行EvaluationTest类的main方法，可以测试所有示例代码的功能：

```bash
# 在linsir-jdk-8目录下执行
mvn exec:java -Dexec.mainClass="com.linsir.jdk.evaluation.EvaluationTest"
```

## 功能展示

### 及早求值功能
- **传统集合操作**：遍历所有元素，立即执行过滤和转换操作。
- **Stream API及早求值**：使用collect()等终端操作触发立即执行。

### 惰性求值功能
- **自定义惰性求值**：使用Supplier接口实现缓存机制，避免重复计算。
- **Stream API惰性求值**：创建Stream时不执行操作，只在调用终端操作时执行。
- **惰性链式调用**：多个操作链接在一起，只在需要时执行。

## 性能对比

测试代码会对比两种求值方式在计算密集型操作上的性能表现：
- 及早求值会立即执行所有计算。
- 惰性求值会推迟计算，并且可以缓存结果以避免重复计算。

## 最佳实践

1. **使用及早求值的场景**：
   - 计算结果会被多次使用。
   - 需要立即验证计算结果。
   - 数据集较小，计算成本低。

2. **使用惰性求值的场景**：
   - 计算成本高，可能不需要所有结果。
   - 处理大数据集，需要避免一次性加载所有数据。
   - 构建复杂的操作链，只需要部分结果。
   - 需要缓存计算结果以提高性能。

3. **Stream API使用建议**：
   - 利用Stream API的惰性特性构建操作链。
   - 合理使用终端操作触发计算。
   - 对于可能重复使用的Stream，考虑缓存结果。